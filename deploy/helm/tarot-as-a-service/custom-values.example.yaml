# Example custom values for HELM_VALUES_B64.
# Copy this file, edit, then encode:
#   cp custom-values.example.yaml custom-values.yaml
#   # edit custom-values.yaml
#   cat custom-values.yaml | base64 -w0
#   # paste output into GitHub Secret HELM_VALUES_B64

replicaCount: 1

image:
  repository: ghcr.io/randomtoy/taas-go
  # tag is overridden by deploy workflow via --set image.tag=
  tag: latest
  pullPolicy: IfNotPresent

# Uncomment if GHCR repo is private:
# imagePullSecrets:
#   - name: ghcr-pull-secret

ingress:
  enabled: true
  className: traefik
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
    cert-manager.io/cluster-issuer: letsencrypt-prod
  host: tarot.randomtoy.dev
  path: /
  pathType: Prefix
  tls:
    enabled: true
    secretName: tarot-as-a-service-tls

resources:
  limits:
    cpu: 250m
    memory: 128Mi
  requests:
    cpu: 50m
    memory: 64Mi

probes:
  liveness:
    enabled: true
    path: /healthz
    initialDelaySeconds: 5
    periodSeconds: 10
    timeoutSeconds: 3
    failureThreshold: 3
  readiness:
    enabled: true
    path: /healthz
    initialDelaySeconds: 5
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 3

# Application environment variables (non-secret)
env:
  HTTP_ADDR: ":8080"
  LOG_LEVEL: "info"
  LLM_PROVIDER: "openrouter"
  LLM_MODEL: "cognitivecomputations/dolphin-mistral-24b-venice-edition:free"
  LLM_FALLBACK_MODELS: "deepseek/deepseek-r1-0528:free"
  OPENROUTER_BASE_URL: "https://openrouter.ai/api/v1"
  LLM_TIMEOUT: "10s"

# Secret reference â€” created by deploy workflow from GitHub Secret OPENROUTER_API_KEY
appSecret:
  enabled: true
  name: tarot-app-secrets
  keys:
    - OPENROUTER_API_KEY

# Pod security
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1000
  runAsGroup: 1000
  fsGroup: 1000

securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  capabilities:
    drop:
      - ALL

# nodeSelector: {}
# tolerations: []
# affinity: {}
